{% extends "master.html" %}

{% block content %}
<h2>Task {{ vm.code }}</h2>
<br/>
<div class="mb-3">
    <label for="subject">Subject</label>
    <input class="form-control" id="subject" name="subject" required="" size="255" type="text" value="{{ vm.subject }}" readonly />          
</div>    
<div class="mb-3">
    <label for="due_date">Due Date</label>
    <input class="form-control" id="due_date" name="due_date" required="" type="text" value="{{ vm.due_date.strftime('%Y-%m-%d') }}" readonly />
</div>
<div class="mb-3">
    <label for="status">Status</label>
    <input class="form-control" id="status" name="status" required="" type="text" value="{{ "Pending" if vm.status == 0 else "In Progress" if vm.status == 1 else "Completed" if vm.status == 2 else "Cancelled" }}" readonly />
</div>
<div class="mb-3">
    <label for="priority">Priority</label>
    <input class="form-control" id="priority" name="priority" required="" type="text" value="{{ "Normal" if vm.priority == 1 else "High" if vm.priority == 2 else "Low" }}" readonly />
</div>
<div class="mb-3">
    <label for="progress">Progress</label>
    <input class="form-control" id="progress" name="progress" required="" type="text" value="{{ "%.2f" % ((vm.progress|default(0))) }}" readonly />
</div>
<div class="mb-3">
    <label for="notes">Notes</label>
    <textarea class="form-control" id="notes" name="notes" required="" rows="4">{{ vm.notes }}</textarea>
</div>
<div>
        <button id="goBackButton" class="btn btn-secondary" type="button" value="Go Back"><i class="bi bi-arrow-left"></i> Go Back</button>
        <button id="editButton" class="btn btn-primary" type="button" value="Edit Task"><i class="bi bi-pencil"></i> Edit Notes</button>
        <button id="completeButton" class="btn btn-success" type="button" value="Complete Task" data-bs-toggle="modal" data-bs-target="#completeModal"><i class="bi bi-check2-circle"></i> Complete Task</button>
        <button id="reportProgressButton" class="btn btn-secondary" type="button" value="Report Progress"><i class="bi bi-bar-chart"></i> Report Progress</button>
        <button id="promoteButton" class="btn btn-secondary" type="button" value="Promote Task"><i class="bi bi-arrow-up-circle"></i> Promote</button>
        <button id="demoteButton" class="btn btn-secondary" type="button" value="Demote Task"><i class="bi bi-arrow-down-circle"></i> Demote</button>
        <button id="snoozeButton" class="btn btn-secondary" type="button" value="Snooze Task"><i class="bi bi-alarm"></i> Snooze</button>  
        <button id="deleteButton" class="btn btn-danger" type="button" value="Cancel"><i class="bi bi-trash"></i> Cancel</button>
</div>

<div class="modal fade" id="completeModal" tabindex="-1" aria-labelledby="completeModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="completeModalLabel">Complete Task</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to complete this task?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
                <form id="completeForm" method="post" action="{{ url_for('task_complete', task_id=vm.id) }}" style="display:inline;">
                    <button type="submit" class="btn btn-success">Yes</button>
                </form>
            </div>
        </div>
    </div>
</div>
<br/>
{% endblock %} 

{% block scripts %}
<script type="text/javascript">
    document.getElementById("goBackButton").onclick = function() {
        window.location.href = "{{ url_for('task_index') }}";
    };
    document.getElementById("editButton").onclick = function() {
        window.location.href = "{{ url_for('task_edit', task_id=vm.id) }}";
    };
    document.getElementById("reportProgressButton").onclick = function() {
        alert("Not implemented yet.");
    };
    document.getElementById("promoteButton").onclick = function() {
        alert("Not implemented yet.");
    };
    document.getElementById("demoteButton").onclick = function() {
        alert("Not implemented yet.");
    };
    document.getElementById("snoozeButton").onclick = function() {
        alert("Not implemented yet.");
    };
    document.getElementById("deleteButton").onclick = function() {
        if (confirm("Are you sure you want to delete this task?")) {
            alert("Not implemented yet.");
        }
    };
</script>
{% endblock %}